# Project: PromptLab Preset Showcase

## 一、项目背景与整体规划视角

从规划者角度看，本项目是一个本地运行的 Prompt 预设展示与管理平台，用于快速浏览、检索、复制和维护中英双语提示词。整体目标是：

- 支撑设计类工作流中对高质量 Prompt 的集中管理和复用。
- 在单机环境下提供接近“轻量后台系统”的体验（有展示端，也有管理端）。
- 保持实现简单、可维护，适合个人或小团队持续迭代。

为此整体规划采用：

- 前端：Vite + React + Tailwind + 自定义 `podui.css`，实现深色玻璃拟态风格界面。
- 后端：Node.js + Express + 本地 JSON 文件存储 + 静态资源上传目录。
- 运行方式：前端和后端分别本地启动，端口分别为 `5173` 与 `3001`。

核心业务流程为：

1. 后端从 `presets.json` 读取预设数据并提供 REST API。
2. 前端通过 API 拉取预设列表和设置，按分类/搜索条件展示卡片。
3. 用户可在管理模态框中添加/编辑预设，包括中英双语 Prompt、分类以及图片上传。
4. 用户可通过 Tag 管理器维护标签体系（重命名、合并、置顶等）。
5. 用户可在界面中一键复制 Prompt，并按中/英语言切换展示内容。

## 二、关键设计与实施方案

### 2.1 数据与存储方案

- 预设数据：
  - 存储于后端本地 `presets.json`。
  - 包含字段：`id`、`title`、`promptEn`、`promptZh`、`categories`、`image`、`createdAt` 等。
- 标签/分类：
  - 分类主要由 `categories` 字段中的字符串数组表示。
  - 前端维护一个主分类列表（如“建筑设计”“景观设计”等）用于导航和统计。
  - Tag 管理器提供对所有标签的查看与操作。
- 图片资源：
  - 通过后端的文件上传接口保存到 `uploads` 目录。
  - 前端通过 `http://localhost:3001/<path>` 访问。

### 2.2 前端架构与页面结构

- 入口组件 `App.jsx`：
  - 负责全局状态：当前语言、预设列表、分类、置顶标签、筛选条件等。
  - 通过 `axios` 请求后端 API 获取 `presets` 与 `settings`。
  - 组合 `Header`、`PresetCard`、`AddPresetModal`、`PresetDetailModal`、`TagManagerModal` 等组件完成页面。
- 头部 `Header.jsx`：
  - 顶部 Logo 与标题区域。
  - 语言开关（中文/English）。
  - 搜索输入框。
  - 分类切换按钮和“最新”排序按钮。
  - 入口按钮：新建预设、管理标签。
- 预设卡片 `PresetCard.jsx`：
  - 显示预设封面图、标题、分类角标、摘要 Prompt。
  - 支持复制当前语言对应的 Prompt。
  - 支持悬浮删除按钮删除预设。
- 详情模态框 `PresetDetailModal.jsx`：
  - 展示完整 Prompt、中英双语字段。
  - 支持编辑并保存到后端。
  - 显示所有关联分类标签。
- 新建/编辑预设模态框 `AddPresetModal.jsx`：
  - 表单字段：标题、中/英 Prompt、分类输入与选择、图片上传。
  - 提交后通过 API 持久化到 `presets.json`。
- 标签管理模态框 `TagManagerModal.jsx`：
  - 展示所有标签及引用次数。
  - 支持搜索、选择、重命名、合并、删除、置顶。

### 2.3 多语言与文案管理

- 使用 `client/src/lib/translations.js` 维护中英文文案。
- `App`、中控组件等通过 `lang` 状态切换不同语言的 UI 字段。
- 卡片和模态框根据 `lang` 决定显示 `promptEn` 或 `promptZh`。
- 后续计划将主分类及系统内置标签也纳入 `translations` 映射，使分类在中/英文语言下都能自然显示，同时不破坏数据层面的分类标识。

### 2.4 交互与性能考虑

- 过滤逻辑：
  - 支持根据标题、中英 Prompt 内容进行模糊搜索。
  - 支持按主分类过滤和“最新”排序。
  - 对置顶标签下的预设进行优先展示。
- 性能优化方向：
  - 使用 `useMemo` 缓存过滤和排序结果，避免每次渲染都重新计算。
  - 搜索输入增加防抖，减少计算频率。
  - 图片懒加载以降低首屏负担。
  - 适度精简重度阴影与模糊效果，改善滚动与交互流畅度。

## 三、高层任务拆分（规划视角）

1. 项目初始化（已完成）
   - [x] 初始化 Vite + React 项目结构。
   - [x] 配置 Tailwind 与 `podui.css`，统一 UI 风格。
   - [x] 搭建 Express 后端，提供基础 API 与静态资源服务。

2. 核心展示功能（已完成）
   - [x] 设计并落地预设数据结构与 `presets.json`。
   - [x] 实现预设卡片组件，支持图片、分类角标、摘要、多语言 Prompt。
   - [x] 完成首页布局：头部、搜索框、分类栏、网格卡片。
   - [x] 实现中/英语言切换，并在主要组件中响应。

3. 管理后台与编辑能力（已完成）
   - [x] 创建新建预设模态框，支持上传图片与多分类输入。
   - [x] 实现预设详情与编辑模态框，支持中英 Prompt 编辑。
   - [x] 对接后端 API，实现新增、更新、删除操作。
   - [x] 基于 JSON 存储和 `uploads` 目录的图片管理。

4. 标签体系与高级管理功能（已完成）
   - [x] 构建 Tag 管理器界面，支持查询与分页展示。
   - [x] 支持标签重命名、合并、删除。
   - [x] 支持标签置顶，并在首页排序中优先展示置顶标签相关预设。
   - [x] 将标签配置信息持久化到后端设置文件。

5. UI 打磨与体验优化（进行中）
   - [x] 应用 `podui.css` 样式细节：阴影、圆角、字体、玻璃拟态背景。
   - [x] 调整卡片、模态框、按钮等组件的视觉层级与状态反馈。
   - [x] 优化长列表性能（`useMemo`、输入防抖、图片懒加载等）。

6. 多语言与分类标签完善（规划中）
   - [x] 在 `translations.js` 中为主分类和内置标签增加英文映射。
   - [x] 在 Header、卡片、详情等处统一通过映射显示分类名称。
   - [x] 评估用户自定义标签是否需要提供可选翻译能力（结论：主分类通过映射展示，用户自定义标签保持原文，由命名时体现语种）。

7. 测试与交付（规划中）
   - [ ] 手工回归：新增/编辑/删除预设流程完整可用。
   - [ ] 验证搜索、分类筛选、复制、多语言切换在典型数据量下表现正常。
   - [ ] 检查本地存储文件（`presets.json`、`settings.json`、`uploads` 目录）一致性与健壮性。
   - [ ] 整理使用说明，形成面向最终用户的操作手册。

## 四、任务看板（按阶段划分）

### 4.1 已完成（Done）

- 初始化前端工程与技术栈选型。
- 配置 Tailwind 与 `podui.css`，统一视觉风格。
- 构建 Express 后端，连通 `presets.json` 与静态资源目录。
- 实现预设卡片组件及首页整体布局。
- 支持预设数据的展示、搜索、分类过滤与语言切换。
- 实现新建与编辑预设的前后端流程。
- 建立 Tag 管理器，支持标签的增删改与置顶。

### 4.2 进行中（In Progress）

- UI 细节与交互打磨：
  - 卡片、模态框的动画和过渡统一。
  - 不同分辨率下的响应式适配与网格布局优化。
- 性能优化：
  - 对过滤与排序逻辑使用 `useMemo`。
  - 为搜索输入添加防抖。
  - 为图片启用懒加载。

### 4.3 待规划/待办（Backlog）

- 多语言与标签体系深化：
  - 主分类与内置标签的中英映射。
  - 标签在不同语言下的展示策略。
- 健壮性与错误处理：
  - 后端 API 错误信息提示优化。
  - 文件上传失败时的用户反馈与重试机制。
- 用户体验提升：
  - 快捷操作（例如键盘快捷键、快速复制某一语言 Prompt）。
  - 支持按创建时间、使用频率等更多维度排序。

## 五、当前状态与运行信息

- 项目当前状态：功能基本完整，正处于 UI 打磨与性能优化阶段。
- 前端运行地址：`http://localhost:5173`
- 后端运行地址：`http://localhost:3001`

## 六、后续协作与交付节奏建议

- 在完成当前性能优化与多语言分类完善后，安排一次集中验收。
- 验收通过后，整理一份面向最终使用者的简明操作手册。
- 后续若增加新模型、新类型 Prompt，可按现有数据结构追加，无需大改架构。
